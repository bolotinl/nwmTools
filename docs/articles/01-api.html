<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Historic Records • National Water Model</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../bootstrap.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../mikepkgdown.css" rel="stylesheet">
<meta property="og:title" content="Historic Records">
<meta property="og:description" content="nwmTools">
<meta property="og:image" content="https://github.com/mikejohnson51/nwmHistoric/logo.svg">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
                                                                          <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
                                                                            <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
                                                                              <![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
              <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                  </button>
                  
                  <div class="navbar-brand-container">
                    <a class="navbar-brand" href="../index.html">nwmTools</a>
                      <div class="info">
                        <span class="partof">National Water Model</span>
                          <span class="version version-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
                            </div>
                              </div>
                              </div>
                              <div id="navbar" class="navbar-collapse collapse">
                                <ul class="nav navbar-nav navbar-left">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01-api.html">Historic Records</a>
    </li>
    <li>
      <a href="../articles/02-discovery.html">Feature Discovery</a>
    </li>
    <li>
      <a href="../articles/03-time.html">Time Aggregation{s}</a>
    </li>
    <li>
      <a href="../articles/04-operations.html">Operational Forecasts</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
                                </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mikejohnson51/nwmTools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
                                </ul>
</div>
<!--/.nav-collapse -->
                                          </div>
<!--/.container -->
                                          </div>
<!--/.navbar -->

      

      </header><script src="01-api_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Historic Records</h1>
                        <h4 class="author"><a href="mailto:mikecp11@gmail.com" class="email">mikecp11@gmail.com</a></h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mikejohnson51/nwmTools/blob/master/vignettes/01-api.Rmd"><code>vignettes/01-api.Rmd</code></a></small>
      <div class="hidden name"><code>01-api.Rmd</code></div>

    </div>

    
    
<p>As part of a collaborative research effort, the multi-decadal hitoric simulation products from the <a href="https://water.noaa.gov/about/nwm">NOAA National Water Model</a> (versions 1.2 and 2.0) have been reformatted and exposed through <a href="https://www.cuahsi.org/">CUAHSI</a> at the <a href="https://renci.org/research/hydroshare/">RENCI computing facility</a>. This document outlines how someone can interact with the interface.</p>
<div id="data-extraction-by" class="section level2">
<h2 class="hasAnchor">
<a href="#data-extraction-by" class="anchor"></a>Data Extraction by …</h2>
<p>Reanalysis data can be found with the <code>readNWMdata</code> function. The API requires users to specify NHD Common Identifier(s) (COMID), or NWIS site ID(s) for time series extraction.</p>
<div id="nhd-catchment-identifier-comid" class="section level3">
<h3 class="hasAnchor">
<a href="#nhd-catchment-identifier-comid" class="anchor"></a>NHD Catchment Identifier (COMID)</h3>
<p>NWM reanalysis data can be extracted by NHD Catchment Identifier(s). The following code pulls the complete reanalysis data archive for COMID 17595383, a NHD reach near Goleta, California.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mikejohnson51/nwmTools">nwmTools</a></span><span class="op">)</span>
<span class="va">flows</span> <span class="op">=</span> <span class="fu"><a href="../reference/readNWMdata.html">readNWMdata</a></span><span class="op">(</span>comid <span class="op">=</span> <span class="fl">17595383</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">flows</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 4</span>
<span class="co">#&gt;   model    comid dateTime            flow_cms</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dttm&gt;                 &lt;dbl&gt;</span>
<span class="co">#&gt; 1 NWM2  17595383 1993-01-01 00:00:00    0.210</span>
<span class="co">#&gt; 2 NWM2  17595383 1993-01-01 01:00:00    0.210</span>
<span class="co">#&gt; 3 NWM2  17595383 1993-01-01 02:00:00    0.210</span>
<span class="co">#&gt; 4 NWM2  17595383 1993-01-01 03:00:00    0.210</span>
<span class="co">#&gt; 5 NWM2  17595383 1993-01-01 04:00:00    0.210</span>
<span class="co">#&gt; 6 NWM2  17595383 1993-01-01 05:00:00    0.210</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">flows</span><span class="op">)</span>
<span class="co">#&gt; [1] 227881      4</span></code></pre></div>
</div>
<div id="usgs-nwis-site-number" class="section level3">
<h3 class="hasAnchor">
<a href="#usgs-nwis-site-number" class="anchor"></a>USGS NWIS Site Number</h3>
<p>Alternatively, data can be extracted using USGS NWIS site ID(s).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">flows</span> <span class="op">=</span> <span class="fu"><a href="../reference/readNWMdata.html">readNWMdata</a></span><span class="op">(</span>siteID  <span class="op">=</span> <span class="fl">11120000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">flows</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 5</span>
<span class="co">#&gt;   model comid    dateTime            flow_cms   siteID</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;    &lt;dttm&gt;                 &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 NWM2  17595429 1993-01-01 00:00:00    0.410 11120000</span>
<span class="co">#&gt; 2 NWM2  17595429 1993-01-01 01:00:00    0.410 11120000</span>
<span class="co">#&gt; 3 NWM2  17595429 1993-01-01 02:00:00    0.410 11120000</span>
<span class="co">#&gt; 4 NWM2  17595429 1993-01-01 03:00:00    0.410 11120000</span>
<span class="co">#&gt; 5 NWM2  17595429 1993-01-01 04:00:00    0.420 11120000</span>
<span class="co">#&gt; 6 NWM2  17595429 1993-01-01 05:00:00    0.420 11120000</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">flows</span><span class="op">)</span>
<span class="co">#&gt; [1] 227881      5</span></code></pre></div>
</div>
</div>
<div id="query-modification-by" class="section level2">
<h2 class="hasAnchor">
<a href="#query-modification-by" class="anchor"></a>Query modification by …</h2>
<p>The default behavior is to extract the complete, hourly timeseries in UTC, for the most current model version. Parameters allow data to be modified by data range, timezone and model version as follows:</p>
<div id="date-range" class="section level3">
<h3 class="hasAnchor">
<a href="#date-range" class="anchor"></a>date range</h3>
<p>By default, the API extracts the complete flow record for each ID. This range can constrained by providing a <code>startDate</code> and/or <code>endDate</code> in the form of (“YYYY-MM-DD”).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">utc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readNWMdata.html">readNWMdata</a></span><span class="op">(</span>comid <span class="op">=</span> <span class="fl">17595383</span>, 
                   startDate <span class="op">=</span> <span class="st">"2010-01-01"</span>, 
                   endDate   <span class="op">=</span> <span class="st">"2010-01-31"</span><span class="op">)</span>

<span class="co"># Check time dimensions</span>
<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">utc</span><span class="op">$</span><span class="va">dateTime</span><span class="op">)</span>
<span class="co">#&gt; [1] "2010-01-01 UTC" "2010-01-31 UTC"</span></code></pre></div>
</div>
<div id="time-zone" class="section level3">
<h3 class="hasAnchor">
<a href="#time-zone" class="anchor"></a>time-zone</h3>
<p>NWM output is recorded in UTC. Instead, users can specify a timezone. For our COMID in Goleta, California we can request data in <code>US/Pacific</code> time. Valid times zone can be found with <code><a href="https://rdrr.io/r/base/timezones.html">OlsonNames()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pst</span> <span class="op">=</span> <span class="fu"><a href="../reference/readNWMdata.html">readNWMdata</a></span><span class="op">(</span>comid <span class="op">=</span> <span class="fl">17595383</span>, 
                  startDate <span class="op">=</span> <span class="st">"2010-01-01"</span>, 
                  endDate <span class="op">=</span> <span class="st">"2010-01-31"</span>, 
                  tz <span class="op">=</span> <span class="st">"US/Pacific"</span><span class="op">)</span>

<span class="co"># Check time dimensions</span>
<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">pst</span><span class="op">$</span><span class="va">dateTime</span><span class="op">)</span>
<span class="co">#&gt; [1] "2010-01-01 PST" "2010-01-31 PST"</span></code></pre></div>
<p>Finally, we can plot the UTC return against the PST return:</p>
<p><img src="01-api_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
</div>
<div id="model-version" class="section level3">
<h3 class="hasAnchor">
<a href="#model-version" class="anchor"></a>model version</h3>
<p>The reanalysis product for versions 1.2 and 2.0 of the NWM are available. By default the API extracts data from version 2.0, but data from 1.2 can be requested as well.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pst_v12</span> <span class="op">=</span> <span class="fu"><a href="../reference/readNWMdata.html">readNWMdata</a></span><span class="op">(</span>comid <span class="op">=</span> <span class="fl">17595383</span>, 
                      startDate <span class="op">=</span> <span class="st">"2010-01-01"</span>, 
                      endDate   <span class="op">=</span> <span class="st">"2010-01-31"</span>,
                      tz        <span class="op">=</span> <span class="st">"US/Pacific"</span>,
                      version <span class="op">=</span>  <span class="fl">1.2</span><span class="op">)</span></code></pre></div>
<p><img src="01-api_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<p>In section 2, we will look at how we can facilitate COMID and USGS NWIS discovery. In section 3 we will look at some techniques to handle time aggregations and splitting.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer></footer>
</div>

  


  </body>
</html>
